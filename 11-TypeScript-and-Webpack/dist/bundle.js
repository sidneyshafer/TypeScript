(()=>{"use strict";class e{constructor(e,t,r,s){this.templateEl=document.getElementById(e),this.hostEl=document.getElementById(t);const n=document.importNode(this.templateEl.content,!0);this.element=n.firstElementChild,s&&(this.element.id=s),this.attach(r)}attach(e){this.hostEl.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function t(e){var t;let r=!0,s="";return e.required&&(r=r&&0!==(null===(t=e.value)||void 0===t?void 0:t.toString().trim().length),r||(s="Required field")),null!=e.minLength&&"string"==typeof e.value&&(r=r&&e.value.length>e.minLength,r||(s="Character length must be greater than "+e.minLength)),null!=e.maxLength&&"string"==typeof e.value&&(r=r&&e.value.length<e.maxLength,r||(s="Character length must be less than "+e.maxLength)),null!=e.min&&"number"==typeof e.value&&(r=r&&e.value>e.min,r||(s="Values must be greater than "+e.min)),null!=e.max&&"number"==typeof e.value&&(r=r&&e.value<e.max,r||(s="Values must be less than "+e.max)),[r,s]}var r;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(r||(r={}));class s{constructor(e,t,r,s,n){this.id=e,this.title=t,this.description=r,this.people=s,this.status=n}}class n{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}class i extends n{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new i),this.instance}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}addProject(e,t,n){const i=new s(Math.random.toString(),e,t,n,r.Active);this.projects.push(i),this.updateListeners()}moveProject(e,t){const r=this.projects.find((t=>t.id===e));r&&r.status!==t&&(r.status=t,this.updateListeners())}}const l=i.getInstance();class a extends e{get persons(){return 1===this.project.people?"1 person":`${this.project.people} persons`}constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){}configure(){this.element.addEventListener("dragstart",this.dragStartHandler.bind(this)),this.element.addEventListener("dragend",this.dragEndHandler.bind(this))}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this.project.description}}class o extends e{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProjects=[],this.configure(),this.renderContent()}renderProjects(){document.getElementById(`${this.type}-project-list`).innerHTML="";for(const e of this.assignedProjects)new a(this.element.querySelector("ul").id,e)}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const t=e.dataTransfer.getData("text/plain"),s="active"===this.type?r.Active:r.Finished;l.moveProject(t,s)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler.bind(this)),this.element.addEventListener("dragleave",this.dragLeaveHandler.bind(this)),this.element.addEventListener("drop",this.dropHandler.bind(this)),l.addListener((e=>{const t=e.filter((e=>"active"===this.type?e.status===r.Active:e.status==r.Finished));this.assignedProjects=t,this.renderProjects()}))}renderContent(){const e=`${this.type}-project-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}}new class extends e{constructor(){super("project-input","app",!0,"user-input"),this.titleInputEl=this.element.querySelector("#title"),this.descInputEl=this.element.querySelector("#description"),this.peopleInputEl=this.element.querySelector("#people"),this.titleErrorEl=this.element.querySelector("#title-error"),this.descErrorEl=this.element.querySelector("#description-error"),this.peopleErrorEl=this.element.querySelector("#people-error"),this.configure()}gatherUserInput(){const e=this.titleInputEl.value,r=this.descInputEl.value,s=this.peopleInputEl.value,n={value:e,required:!0},i={value:r,required:!0,minLength:5},l={value:+s,required:!0,min:0,max:5},[a,o]=t(n),[h,d]=t(i),[c,u]=t(l);return a&&h&&c?[e,r,+s]:(this.titleErrorEl.innerText=o,this.descErrorEl.innerText=d,void(this.peopleErrorEl.innerText=u))}configure(){this.element.addEventListener("submit",this.submitHandler.bind(this))}renderContent(){}clearInputs(){this.titleInputEl.value="",this.descInputEl.value="",this.peopleInputEl.value=""}clearErrors(){this.titleErrorEl.innerText="",this.descErrorEl.innerText="",this.peopleErrorEl.innerText=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,r,s]=t;l.addProject(e,r,s),this.clearInputs(),this.clearErrors()}}},new o("active"),new o("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0pwSCxLQUFLK0YsYUFBYTdFLE1BQVEsR0FDMUJsQixLQUFLZ0csWUFBWTlFLE1BQVEsR0FDekJsQixLQUFLaUcsY0FBYy9FLE1BQVEsRUFDL0IsQ0FFUSxXQUFBbUcsR0FDSnJILEtBQUtrRyxhQUFhZ0IsVUFBWSxHQUM5QmxILEtBQUttRyxZQUFZZSxVQUFZLEdBQzdCbEgsS0FBS29HLGNBQWNjLFVBQVksRUFDbkMsQ0FFUSxhQUFBQyxDQUFjcEQsR0FDbEJBLEVBQU1rQixpQkFDTixNQUFNcUMsRUFBWXRILEtBQUtxRyxrQkFDdkIsR0FBSWtCLE1BQU1DLFFBQVFGLEdBQVksQ0FDMUIsTUFBTzFGLEVBQU82RixFQUFNM0YsR0FBVXdGLEVBRTlCOUQsRUFBYVosV0FBV2hCLEVBQU82RixFQUFNM0YsR0FDckM5QixLQUFLb0gsY0FDTHBILEtBQUtxSCxhQUNULENBQ0osR0QzRkosSUFBSTVDLEVBQVksVUFDaEIsSUFBSUEsRUFBWSxXIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VjdGlvbi05LWRyYWctYW5kLWRyb3AtcHJvamVjdC8uL3NyYy9jb21wb25lbnRzL2Jhc2UtY29tcG9uZW50LnRzIiwid2VicGFjazovL3NlY3Rpb24tOS1kcmFnLWFuZC1kcm9wLXByb2plY3QvLi9zcmMvdXRpbC92YWxpZGF0aW9uLnRzIiwid2VicGFjazovL3NlY3Rpb24tOS1kcmFnLWFuZC1kcm9wLXByb2plY3QvLi9zcmMvbW9kZWxzL3Byb2plY3QudHMiLCJ3ZWJwYWNrOi8vc2VjdGlvbi05LWRyYWctYW5kLWRyb3AtcHJvamVjdC8uL3NyYy9zdGF0ZS9wcm9qZWN0LXN0YXRlLnRzIiwid2VicGFjazovL3NlY3Rpb24tOS1kcmFnLWFuZC1kcm9wLXByb2plY3QvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWl0ZW0udHMiLCJ3ZWJwYWNrOi8vc2VjdGlvbi05LWRyYWctYW5kLWRyb3AtcHJvamVjdC8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtbGlzdC50cyIsIndlYnBhY2s6Ly9zZWN0aW9uLTktZHJhZy1hbmQtZHJvcC1wcm9qZWN0Ly4vc3JjL2FwcC50cyIsIndlYnBhY2s6Ly9zZWN0aW9uLTktZHJhZy1hbmQtZHJvcC1wcm9qZWN0Ly4vc3JjL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb21wb25lbnQgQmFzZSBDbGFzc1xyXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQ29tcG9uZW50PFQgZXh0ZW5kcyBIVE1MRWxlbWVudCwgVSBleHRlbmRzIEhUTUxFbGVtZW50PiB7XHJcbiAgICB0ZW1wbGF0ZUVsOiBIVE1MVGVtcGxhdGVFbGVtZW50O1xyXG4gICAgaG9zdEVsOiBUO1xyXG4gICAgZWxlbWVudDogVTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICB0ZW1wbGF0ZUlkOiBzdHJpbmcsIFxyXG4gICAgICAgIGhvc3RFbElkOiBzdHJpbmcsIFxyXG4gICAgICAgIGluc2VydEF0U3RhcnQ6IGJvb2xlYW4sXHJcbiAgICAgICAgbmV3RWxJZD86IHN0cmluZyxcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMudGVtcGxhdGVFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRlbXBsYXRlSWQpISBhcyBIVE1MVGVtcGxhdGVFbGVtZW50O1xyXG4gICAgICAgIHRoaXMuaG9zdEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaG9zdEVsSWQpISBhcyBUO1xyXG5cclxuICAgICAgICBjb25zdCBpbXBvcnRlZE5vZGUgPSBkb2N1bWVudC5pbXBvcnROb2RlKHRoaXMudGVtcGxhdGVFbC5jb250ZW50LCB0cnVlKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBpbXBvcnRlZE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQgYXMgVTtcclxuXHJcbiAgICAgICAgaWYgKG5ld0VsSWQpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmlkID0gbmV3RWxJZDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuYXR0YWNoKGluc2VydEF0U3RhcnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXR0YWNoKGluc2VydEF0U3RhcnQ6IGJvb2xlYW4pIHtcclxuICAgICAgICB0aGlzLmhvc3RFbC5pbnNlcnRBZGphY2VudEVsZW1lbnQoaW5zZXJ0QXRTdGFydCA/ICdhZnRlcmJlZ2luJyA6ICdiZWZvcmVlbmQnLCB0aGlzLmVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIGFic3RyYWN0IGNvbmZpZ3VyZSgpOiB2b2lkO1xyXG4gICAgYWJzdHJhY3QgcmVuZGVyQ29udGVudCgpOiB2b2lkO1xyXG59IiwiZXhwb3J0IGludGVyZmFjZSBWYWxpZGF0ZSB7XHJcbiAgICB2YWx1ZT86IHN0cmluZyB8IG51bWJlcjtcclxuICAgIHJlcXVpcmVkPzogYm9vbGVhbjtcclxuICAgIG1pbkxlbmd0aD86IG51bWJlclxyXG4gICAgbWF4TGVuZ3RoPzogbnVtYmVyO1xyXG4gICAgbWluPzogbnVtYmVyO1xyXG4gICAgbWF4PzogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGUodmFsaWRhdGVJbnB1dDogVmFsaWRhdGUpOiBbYm9vbGVhbiwgc3RyaW5nXSB7XHJcbiAgICBsZXQgaXNWYWxpZCA9IHRydWU7XHJcbiAgICBsZXQgZXJyb3JTdHIgPSAnJztcclxuXHJcbiAgICBpZiAodmFsaWRhdGVJbnB1dC5yZXF1aXJlZCkge1xyXG4gICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRlSW5wdXQudmFsdWU/LnRvU3RyaW5nKCkudHJpbSgpLmxlbmd0aCAhPT0gMDtcclxuICAgICAgICBpZighaXNWYWxpZCkge1xyXG4gICAgICAgICAgICBlcnJvclN0ciA9ICdSZXF1aXJlZCBmaWVsZCdcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAodmFsaWRhdGVJbnB1dC5taW5MZW5ndGggIT0gbnVsbCAmJiB0eXBlb2YgdmFsaWRhdGVJbnB1dC52YWx1ZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0ZUlucHV0LnZhbHVlLmxlbmd0aCA+IHZhbGlkYXRlSW5wdXQubWluTGVuZ3RoO1xyXG4gICAgICAgIGlmKCFpc1ZhbGlkKSB7XHJcbiAgICAgICAgICAgIGVycm9yU3RyID0gJ0NoYXJhY3RlciBsZW5ndGggbXVzdCBiZSBncmVhdGVyIHRoYW4gJyArIHZhbGlkYXRlSW5wdXQubWluTGVuZ3RoO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICh2YWxpZGF0ZUlucHV0Lm1heExlbmd0aCAhPSBudWxsICYmIHR5cGVvZiB2YWxpZGF0ZUlucHV0LnZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRlSW5wdXQudmFsdWUubGVuZ3RoIDwgdmFsaWRhdGVJbnB1dC5tYXhMZW5ndGg7XHJcbiAgICAgICAgaWYoIWlzVmFsaWQpIHtcclxuICAgICAgICAgICAgZXJyb3JTdHIgPSAnQ2hhcmFjdGVyIGxlbmd0aCBtdXN0IGJlIGxlc3MgdGhhbiAnICsgdmFsaWRhdGVJbnB1dC5tYXhMZW5ndGg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHZhbGlkYXRlSW5wdXQubWluICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRlSW5wdXQudmFsdWUgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGVJbnB1dC52YWx1ZSA+IHZhbGlkYXRlSW5wdXQubWluO1xyXG4gICAgICAgIGlmKCFpc1ZhbGlkKSB7XHJcbiAgICAgICAgICAgIGVycm9yU3RyID0gJ1ZhbHVlcyBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAnICsgdmFsaWRhdGVJbnB1dC5taW47XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHZhbGlkYXRlSW5wdXQubWF4ICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRlSW5wdXQudmFsdWUgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGVJbnB1dC52YWx1ZSA8IHZhbGlkYXRlSW5wdXQubWF4O1xyXG4gICAgICAgIGlmKCFpc1ZhbGlkKSB7XHJcbiAgICAgICAgICAgIGVycm9yU3RyID0gJ1ZhbHVlcyBtdXN0IGJlIGxlc3MgdGhhbiAnICsgdmFsaWRhdGVJbnB1dC5tYXg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIFtpc1ZhbGlkLCBlcnJvclN0cl07XHJcbn0iLCJleHBvcnQgZW51bSBQcm9qZWN0U3RhdHVzIHsgQWN0aXZlLCBGaW5pc2hlZCB9XHJcblxyXG5leHBvcnQgY2xhc3MgUHJvamVjdCB7XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICAgICAgcHVibGljIGlkOiBzdHJpbmcsIFxyXG4gICAgICAgICAgICBwdWJsaWMgdGl0bGU6IHN0cmluZywgXHJcbiAgICAgICAgICAgIHB1YmxpYyBkZXNjcmlwdGlvbjogc3RyaW5nLCBcclxuICAgICAgICAgICAgcHVibGljIHBlb3BsZTogbnVtYmVyLCBcclxuICAgICAgICAgICAgcHVibGljIHN0YXR1czogUHJvamVjdFN0YXR1c1xyXG4gICAgKSB7fVxyXG59IiwiaW1wb3J0IHsgUHJvamVjdCwgUHJvamVjdFN0YXR1cyB9IGZyb20gXCIuLi9tb2RlbHMvcHJvamVjdFwiO1xyXG5cclxuLy8gQ3VzdG9tZXIgTGlzdGVuZXIgVHlwZVxyXG50eXBlIExpc3RlbmVyPFQ+ID0gKGl0ZW1zOiBUW10pID0+IHZvaWQ7XHJcblxyXG5jbGFzcyBTdGF0ZTxUPiB7XHJcbiAgICBwcm90ZWN0ZWQgbGlzdGVuZXJzOiBMaXN0ZW5lcjxUPltdID0gW107XHJcblxyXG4gICAgYWRkTGlzdGVuZXIobGlzdGVuZXJGbjogTGlzdGVuZXI8VD4pIHtcclxuICAgICAgICB0aGlzLmxpc3RlbmVycy5wdXNoKGxpc3RlbmVyRm4pO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyBQcm9qZWN0IFN0YXRlIE1hbmFnZW1lbnRcclxuZXhwb3J0IGNsYXNzIFByb2plY3RTdGF0ZSBleHRlbmRzIFN0YXRlPFByb2plY3Q+IHtcclxuICAgIHByaXZhdGUgcHJvamVjdHM6IFByb2plY3RbXSA9IFtdO1xyXG4gICAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFByb2plY3RTdGF0ZTtcclxuXHJcbiAgICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGdldEluc3RhbmNlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmluc3RhbmNlID0gbmV3IFByb2plY3RTdGF0ZSgpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgdXBkYXRlTGlzdGVuZXJzKCkge1xyXG4gICAgICAgIGZvciAoY29uc3QgbGlzdGVuZXJGbiBvZiB0aGlzLmxpc3RlbmVycykge1xyXG4gICAgICAgICAgICBsaXN0ZW5lckZuKHRoaXMucHJvamVjdHMuc2xpY2UoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGFkZFByb2plY3QodGl0bGU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZywgbnVtYk9mUGVvcGxlOiBudW1iZXIpIHtcclxuICAgICAgICBjb25zdCBuZXdQcm9qZWN0ID0gbmV3IFByb2plY3QoXHJcbiAgICAgICAgICAgIE1hdGgucmFuZG9tLnRvU3RyaW5nKCksXHJcbiAgICAgICAgICAgIHRpdGxlLFxyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgbnVtYk9mUGVvcGxlLFxyXG4gICAgICAgICAgICBQcm9qZWN0U3RhdHVzLkFjdGl2ZVxyXG4gICAgICAgIClcclxuICAgICAgICB0aGlzLnByb2plY3RzLnB1c2gobmV3UHJvamVjdCk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBtb3ZlUHJvamVjdChwcm9qZWN0SWQ6IHN0cmluZywgbmV3U3RhdHVzOiBQcm9qZWN0U3RhdHVzKSB7XHJcbiAgICAgICAgY29uc3QgcHJvamVjdCA9IHRoaXMucHJvamVjdHMuZmluZChwcmogPT4gcHJqLmlkID09PSBwcm9qZWN0SWQpO1xyXG4gICAgICAgIGlmIChwcm9qZWN0ICYmIHByb2plY3Quc3RhdHVzICE9PSBuZXdTdGF0dXMpIHtcclxuICAgICAgICAgICAgcHJvamVjdC5zdGF0dXMgPSBuZXdTdGF0dXM7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTGlzdGVuZXJzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcHJvamVjdFN0YXRlID0gUHJvamVjdFN0YXRlLmdldEluc3RhbmNlKCk7IiwiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi9iYXNlLWNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCc7XHJcbmltcG9ydCB7IERyYWdnYWJsZSB9IGZyb20gJy4uL2ludGVyZmFjZXMvZHJhZy1kcm9wJztcclxuXHJcbi8vIFByb2plY3RJdGVtIENsYXNzXHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0SXRlbSBleHRlbmRzIENvbXBvbmVudDxIVE1MVUxpc3RFbGVtZW50LCBIVE1MTElFbGVtZW50PiBpbXBsZW1lbnRzIERyYWdnYWJsZSB7XHJcbiAgICBwcml2YXRlIHByb2plY3Q6IFByb2plY3Q7XHJcblxyXG4gICAgZ2V0IHBlcnNvbnMoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMucHJvamVjdC5wZW9wbGUgPT09IDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICcxIHBlcnNvbic7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGAke3RoaXMucHJvamVjdC5wZW9wbGV9IHBlcnNvbnNgO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3RydWN0b3IoaG9zdElkOiBzdHJpbmcsIHByb2plY3Q6IFByb2plY3QpIHtcclxuICAgICAgICBzdXBlcignc2luZ2xlLXByb2plY3QnLCBob3N0SWQsIGZhbHNlLCBwcm9qZWN0LmlkKTtcclxuICAgICAgICB0aGlzLnByb2plY3QgPSBwcm9qZWN0O1xyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGRyYWdTdGFydEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuc2V0RGF0YSgndGV4dC9wbGFpbicsIHRoaXMucHJvamVjdC5pZCk7XHJcbiAgICAgICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5lZmZlY3RBbGxvd2VkID0gJ21vdmUnO1xyXG4gICAgfVxyXG5cclxuICAgIGRyYWdFbmRIYW5kbGVyKF86IERyYWdFdmVudCk6IHZvaWQge31cclxuXHJcbiAgICBjb25maWd1cmUoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIHRoaXMuZHJhZ1N0YXJ0SGFuZGxlci5iaW5kKHRoaXMpKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIHRoaXMuZHJhZ0VuZEhhbmRsZXIuYmluZCh0aGlzKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyQ29udGVudCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QudGl0bGU7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gzJykhLnRleHRDb250ZW50ID0gdGhpcy5wZXJzb25zICsgJyBhc3NpZ25lZCc7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3AnKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QuZGVzY3JpcHRpb247XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi9iYXNlLWNvbXBvbmVudFwiO1xyXG5pbXBvcnQgeyBQcm9qZWN0SXRlbSB9IGZyb20gXCIuL3Byb2plY3QtaXRlbVwiO1xyXG5pbXBvcnQgeyBQcm9qZWN0LCBQcm9qZWN0U3RhdHVzIH0gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCI7XHJcbmltcG9ydCB7IERyYWdUYXJnZXQgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9kcmFnLWRyb3BcIjtcclxuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSBcIi4uL3N0YXRlL3Byb2plY3Qtc3RhdGVcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0TGlzdCBleHRlbmRzIENvbXBvbmVudDxIVE1MRGl2RWxlbWVudCwgSFRNTEVsZW1lbnQ+IGltcGxlbWVudHMgRHJhZ1RhcmdldCB7XHJcblxyXG4gICAgcHJpdmF0ZSBhc3NpZ25lZFByb2plY3RzOiBQcm9qZWN0W107XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB0eXBlOiAnYWN0aXZlJyB8ICdmaW5pc2hlZCcpIHtcclxuICAgICAgICBzdXBlcigncHJvamVjdC1saXN0JywgJ2FwcCcsIGZhbHNlLCBgJHt0eXBlfS1wcm9qZWN0c2ApO1xyXG4gICAgICAgIHRoaXMuYXNzaWduZWRQcm9qZWN0cyA9IFtdO1xyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVuZGVyUHJvamVjdHMoKSB7XHJcbiAgICAgICAgY29uc3QgbGlzdEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYCR7dGhpcy50eXBlfS1wcm9qZWN0LWxpc3RgKSBhcyBIVE1MVUxpc3RFbGVtZW50O1xyXG4gICAgICAgIGxpc3RFbC5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGhpcy5hc3NpZ25lZFByb2plY3RzKSB7XHJcbiAgICAgICAgICAgIG5ldyBQcm9qZWN0SXRlbSh0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSEuaWQsIGl0ZW0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBkcmFnT3ZlckhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgICAgIGlmIChldmVudC5kYXRhVHJhbnNmZXIgJiYgZXZlbnQuZGF0YVRyYW5zZmVyLnR5cGVzWzBdID09PSAndGV4dC9wbGFpbicpIHtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgY29uc3QgbGlzdEVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhO1xyXG4gICAgICAgICAgICBsaXN0RWwuY2xhc3NMaXN0LmFkZCgnZHJvcHBhYmxlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGRyb3BIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBwcmpJZCA9IGV2ZW50LmRhdGFUcmFuc2ZlciEuZ2V0RGF0YSgndGV4dC9wbGFpbicpO1xyXG4gICAgICAgIGNvbnN0IHByalN0YXR1cyA9IHRoaXMudHlwZSA9PT0gJ2FjdGl2ZScgPyBQcm9qZWN0U3RhdHVzLkFjdGl2ZSA6IFByb2plY3RTdGF0dXMuRmluaXNoZWQ7IFxyXG4gICAgICAgIHByb2plY3RTdGF0ZS5tb3ZlUHJvamVjdChwcmpJZCwgcHJqU3RhdHVzKTtcclxuICAgIH1cclxuXHJcbiAgICBkcmFnTGVhdmVIYW5kbGVyKF86IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGxpc3RFbCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpITtcclxuICAgICAgICBsaXN0RWwuY2xhc3NMaXN0LnJlbW92ZSgnZHJvcHBhYmxlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uZmlndXJlKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIHRoaXMuZHJhZ092ZXJIYW5kbGVyLmJpbmQodGhpcykpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCB0aGlzLmRyYWdMZWF2ZUhhbmRsZXIuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCB0aGlzLmRyb3BIYW5kbGVyLmJpbmQodGhpcykpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHByb2plY3RTdGF0ZS5hZGRMaXN0ZW5lcigocHJvamVjdHM6IFByb2plY3RbXSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCByZWxldmFudFByb2plY3RzID0gcHJvamVjdHMuZmlsdGVyKHByaiA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50eXBlID09PSAnYWN0aXZlJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmouc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkFjdGl2ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBwcmouc3RhdHVzID09IFByb2plY3RTdGF0dXMuRmluaXNoZWQ7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmFzc2lnbmVkUHJvamVjdHMgPSByZWxldmFudFByb2plY3RzO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlclByb2plY3RzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyQ29udGVudCgpIHtcclxuICAgICAgICBjb25zdCBsaXN0SWQgPSBgJHt0aGlzLnR5cGV9LXByb2plY3QtbGlzdGA7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkID0gbGlzdElkO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMicpIS50ZXh0Q29udGVudCA9IHRoaXMudHlwZS50b1VwcGVyQ2FzZSgpICsgJyBQUk9KRUNUUyc7XHJcbiAgICB9XHJcbn0iLCIvLyBJbXBvcnQgSW50ZXJmYWNlc1xyXG5pbXBvcnQgeyBQcm9qZWN0SW5wdXQgfSBmcm9tIFwiLi9jb21wb25lbnRzL3Byb2plY3QtaW5wdXRcIjtcclxuaW1wb3J0IHsgUHJvamVjdExpc3QgfSBmcm9tIFwiLi9jb21wb25lbnRzL3Byb2plY3QtbGlzdFwiO1xyXG5cclxubmV3IFByb2plY3RJbnB1dCgpO1xyXG5uZXcgUHJvamVjdExpc3QoJ2FjdGl2ZScpO1xyXG5uZXcgUHJvamVjdExpc3QoJ2ZpbmlzaGVkJyk7IiwiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSBcIi4vYmFzZS1jb21wb25lbnRcIjtcclxuaW1wb3J0IHsgVmFsaWRhdGUsIHZhbGlkYXRlIH0gZnJvbSBcIi4uL3V0aWwvdmFsaWRhdGlvblwiO1xyXG5pbXBvcnQgeyBwcm9qZWN0U3RhdGUgfSBmcm9tIFwiLi4vc3RhdGUvcHJvamVjdC1zdGF0ZVwiO1xyXG5cclxuLy8gUHJvamVjdElucHV0IENsYXNzXHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0SW5wdXQgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTERpdkVsZW1lbnQsIEhUTUxGb3JtRWxlbWVudD4ge1xyXG4gICAgdGl0bGVJbnB1dEVsOiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgZGVzY0lucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBwZW9wbGVJbnB1dEVsOiBIVE1MSW5wdXRFbGVtZW50O1xyXG5cclxuICAgIHRpdGxlRXJyb3JFbDogSFRNTEVsZW1lbnQ7XHJcbiAgICBkZXNjRXJyb3JFbDogSFRNTEVsZW1lbnQ7XHJcbiAgICBwZW9wbGVFcnJvckVsOiBIVE1MRWxlbWVudDtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigncHJvamVjdC1pbnB1dCcsICdhcHAnLCB0cnVlLCAndXNlci1pbnB1dCcpO1xyXG5cclxuICAgICAgICB0aGlzLnRpdGxlSW5wdXRFbCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjdGl0bGUnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICAgIHRoaXMuZGVzY0lucHV0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI2Rlc2NyaXB0aW9uJykgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICB0aGlzLnBlb3BsZUlucHV0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI3Blb3BsZScpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcblxyXG4gICAgICAgIHRoaXMudGl0bGVFcnJvckVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0aXRsZS1lcnJvcicpIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICAgIHRoaXMuZGVzY0Vycm9yRWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI2Rlc2NyaXB0aW9uLWVycm9yJykgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5wZW9wbGVFcnJvckVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwZW9wbGUtZXJyb3InKSBhcyBIVE1MRWxlbWVudDtcclxuXHJcbiAgICAgICAgdGhpcy5jb25maWd1cmUoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdhdGhlclVzZXJJbnB1dCgpOiBbc3RyaW5nLCBzdHJpbmcsIG51bWJlcl0gfCB2b2lkIHtcclxuICAgICAgICBjb25zdCBlbnRlcmVkVGl0bGUgPSB0aGlzLnRpdGxlSW5wdXRFbC52YWx1ZTtcclxuICAgICAgICBjb25zdCBlbnRlcmVkRGVzYyA9IHRoaXMuZGVzY0lucHV0RWwudmFsdWU7XHJcbiAgICAgICAgY29uc3QgZW50ZXJlZFBlb3BsZSA9IHRoaXMucGVvcGxlSW5wdXRFbC52YWx1ZTtcclxuXHJcbiAgICAgICAgY29uc3QgdGl0bGVWYWxpZGF0ZTogVmFsaWRhdGUgPSB7XHJcbiAgICAgICAgICAgIHZhbHVlOiBlbnRlcmVkVGl0bGUsXHJcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCBkZXNjVmFsaWRhdGU6IFZhbGlkYXRlID0ge1xyXG4gICAgICAgICAgICB2YWx1ZTogZW50ZXJlZERlc2MsXHJcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICBtaW5MZW5ndGg6IDVcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnN0IHBlb3BsZVZhbGlkYXRlOiBWYWxpZGF0ZSA9IHtcclxuICAgICAgICAgICAgdmFsdWU6ICtlbnRlcmVkUGVvcGxlLFxyXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgICAgbWluOiAwLFxyXG4gICAgICAgICAgICBtYXg6IDVcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb25zdCBbaXNUaXRsZVZhbGlkLCB0aXRsZUVycm9yXSA9IHZhbGlkYXRlKHRpdGxlVmFsaWRhdGUpO1xyXG4gICAgICAgIGNvbnN0IFtpc0Rlc2NWYWxpZCwgZGVzY0Vycm9yXSA9IHZhbGlkYXRlKGRlc2NWYWxpZGF0ZSk7XHJcbiAgICAgICAgY29uc3QgW2lzUGVvcGxlVmFsaWQsIHBlb3BsZUVycm9yXSA9IHZhbGlkYXRlKHBlb3BsZVZhbGlkYXRlKTtcclxuXHJcbiAgICAgICAgLy8gQ2hlY2tpbmcgaWYgbm8gaW5wdXQgaXMgZW1wdHlcclxuICAgICAgICBpZiAoIFxyXG4gICAgICAgICAgICAhaXNUaXRsZVZhbGlkIHx8IFxyXG4gICAgICAgICAgICAhaXNEZXNjVmFsaWQgfHwgXHJcbiAgICAgICAgICAgICFpc1Blb3BsZVZhbGlkXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGl0bGVFcnJvckVsLmlubmVyVGV4dCA9IHRpdGxlRXJyb3I7XHJcbiAgICAgICAgICAgIHRoaXMuZGVzY0Vycm9yRWwuaW5uZXJUZXh0ID0gZGVzY0Vycm9yO1xyXG4gICAgICAgICAgICB0aGlzLnBlb3BsZUVycm9yRWwuaW5uZXJUZXh0ID0gcGVvcGxlRXJyb3I7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gW2VudGVyZWRUaXRsZSwgZW50ZXJlZERlc2MsICtlbnRlcmVkUGVvcGxlXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uZmlndXJlKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLnN1Ym1pdEhhbmRsZXIuYmluZCh0aGlzKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyQ29udGVudCgpOiB2b2lkIHt9XHJcblxyXG4gICAgcHJpdmF0ZSBjbGVhcklucHV0cygpIHtcclxuICAgICAgICB0aGlzLnRpdGxlSW5wdXRFbC52YWx1ZSA9ICcnO1xyXG4gICAgICAgIHRoaXMuZGVzY0lucHV0RWwudmFsdWUgPSAnJztcclxuICAgICAgICB0aGlzLnBlb3BsZUlucHV0RWwudmFsdWUgPSAnJztcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNsZWFyRXJyb3JzKCkge1xyXG4gICAgICAgIHRoaXMudGl0bGVFcnJvckVsLmlubmVyVGV4dCA9ICcnO1xyXG4gICAgICAgIHRoaXMuZGVzY0Vycm9yRWwuaW5uZXJUZXh0ID0gJyc7XHJcbiAgICAgICAgdGhpcy5wZW9wbGVFcnJvckVsLmlubmVyVGV4dCA9ICcnO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc3VibWl0SGFuZGxlcihldmVudDogRXZlbnQpIHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGNvbnN0IHVzZXJJbnB1dCA9IHRoaXMuZ2F0aGVyVXNlcklucHV0KCk7XHJcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodXNlcklucHV0KSkge1xyXG4gICAgICAgICAgICBjb25zdCBbdGl0bGUsIGRlc2MsIHBlb3BsZV0gPSB1c2VySW5wdXQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBwcm9qZWN0U3RhdGUuYWRkUHJvamVjdCh0aXRsZSwgZGVzYywgcGVvcGxlKTtcclxuICAgICAgICAgICAgdGhpcy5jbGVhcklucHV0cygpO1xyXG4gICAgICAgICAgICB0aGlzLmNsZWFyRXJyb3JzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59Il0sIm5hbWVzIjpbIkNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwidGVtcGxhdGVJZCIsImhvc3RFbElkIiwiaW5zZXJ0QXRTdGFydCIsIm5ld0VsSWQiLCJ0aGlzIiwidGVtcGxhdGVFbCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJob3N0RWwiLCJpbXBvcnRlZE5vZGUiLCJpbXBvcnROb2RlIiwiY29udGVudCIsImVsZW1lbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImlkIiwiYXR0YWNoIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwidmFsaWRhdGUiLCJ2YWxpZGF0ZUlucHV0IiwiaXNWYWxpZCIsImVycm9yU3RyIiwicmVxdWlyZWQiLCJ2YWx1ZSIsInRvU3RyaW5nIiwidHJpbSIsImxlbmd0aCIsIm1pbkxlbmd0aCIsIm1heExlbmd0aCIsIm1pbiIsIm1heCIsIlByb2plY3RTdGF0dXMiLCJQcm9qZWN0IiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInBlb3BsZSIsInN0YXR1cyIsIlN0YXRlIiwibGlzdGVuZXJzIiwiYWRkTGlzdGVuZXIiLCJsaXN0ZW5lckZuIiwicHVzaCIsIlByb2plY3RTdGF0ZSIsInN1cGVyIiwicHJvamVjdHMiLCJnZXRJbnN0YW5jZSIsImluc3RhbmNlIiwidXBkYXRlTGlzdGVuZXJzIiwic2xpY2UiLCJhZGRQcm9qZWN0IiwibnVtYk9mUGVvcGxlIiwibmV3UHJvamVjdCIsIk1hdGgiLCJyYW5kb20iLCJBY3RpdmUiLCJtb3ZlUHJvamVjdCIsInByb2plY3RJZCIsIm5ld1N0YXR1cyIsInByb2plY3QiLCJmaW5kIiwicHJqIiwicHJvamVjdFN0YXRlIiwiUHJvamVjdEl0ZW0iLCJwZXJzb25zIiwiaG9zdElkIiwiY29uZmlndXJlIiwicmVuZGVyQ29udGVudCIsImRyYWdTdGFydEhhbmRsZXIiLCJldmVudCIsImRhdGFUcmFuc2ZlciIsInNldERhdGEiLCJlZmZlY3RBbGxvd2VkIiwiZHJhZ0VuZEhhbmRsZXIiLCJfIiwiYWRkRXZlbnRMaXN0ZW5lciIsImJpbmQiLCJxdWVyeVNlbGVjdG9yIiwidGV4dENvbnRlbnQiLCJQcm9qZWN0TGlzdCIsInR5cGUiLCJhc3NpZ25lZFByb2plY3RzIiwicmVuZGVyUHJvamVjdHMiLCJpbm5lckhUTUwiLCJpdGVtIiwiZHJhZ092ZXJIYW5kbGVyIiwidHlwZXMiLCJwcmV2ZW50RGVmYXVsdCIsImNsYXNzTGlzdCIsImFkZCIsImRyb3BIYW5kbGVyIiwicHJqSWQiLCJnZXREYXRhIiwicHJqU3RhdHVzIiwiRmluaXNoZWQiLCJkcmFnTGVhdmVIYW5kbGVyIiwicmVtb3ZlIiwicmVsZXZhbnRQcm9qZWN0cyIsImZpbHRlciIsImxpc3RJZCIsInRvVXBwZXJDYXNlIiwidGl0bGVJbnB1dEVsIiwiZGVzY0lucHV0RWwiLCJwZW9wbGVJbnB1dEVsIiwidGl0bGVFcnJvckVsIiwiZGVzY0Vycm9yRWwiLCJwZW9wbGVFcnJvckVsIiwiZ2F0aGVyVXNlcklucHV0IiwiZW50ZXJlZFRpdGxlIiwiZW50ZXJlZERlc2MiLCJlbnRlcmVkUGVvcGxlIiwidGl0bGVWYWxpZGF0ZSIsImRlc2NWYWxpZGF0ZSIsInBlb3BsZVZhbGlkYXRlIiwiaXNUaXRsZVZhbGlkIiwidGl0bGVFcnJvciIsImlzRGVzY1ZhbGlkIiwiZGVzY0Vycm9yIiwiaXNQZW9wbGVWYWxpZCIsInBlb3BsZUVycm9yIiwiaW5uZXJUZXh0Iiwic3VibWl0SGFuZGxlciIsImNsZWFySW5wdXRzIiwiY2xlYXJFcnJvcnMiLCJ1c2VySW5wdXQiLCJBcnJheSIsImlzQXJyYXkiLCJkZXNjIl0sInNvdXJjZVJvb3QiOiIifQ==